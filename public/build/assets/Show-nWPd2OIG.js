import{_ as dt}from"./AuthenticatedLayout-nwCEQW_C.js";import{y as ct,q as E,u as ft,z as mt,s as ht,g as pt,a as h,d,h as vt,w as b,b as u,f as I,t as j,l as nt,k as $t,F as gt,o as yt}from"./app-DCFeNiTs.js";import{a as z}from"./index-DMXFl-X3.js";import{f as bt,b as at,c as Y,d as xt,e as Dt,g as K}from"./index-DQuuFziJ.js";import{s as wt}from"./index-C5Nsv1ZJ.js";import"./ApplicationLogo-B6B4ioSt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";var Z={exports:{}},Mt=Z.exports,rt;function St(){return rt||(rt=1,(function(D,X){(function(_,T){D.exports=T()})(Mt,(function(){var _=1e3,T=6e4,c=36e5,P="millisecond",V="second",O="minute",k="hour",w="day",M="week",n="month",A="quarter",l="year",S="date",tt="Invalid Date",it=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,ot=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,lt={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(r){var s=["th","st","nd","rd"],t=r%100;return"["+r+(s[(t-20)%10]||s[t]||s[0])+"]"}},G=function(r,s,t){var a=String(r);return!a||a.length>=s?r:""+Array(s+1-a.length).join(t)+r},ut={s:G,z:function(r){var s=-r.utcOffset(),t=Math.abs(s),a=Math.floor(t/60),e=t%60;return(s<=0?"+":"-")+G(a,2,"0")+":"+G(e,2,"0")},m:function r(s,t){if(s.date()<t.date())return-r(t,s);var a=12*(t.year()-s.year())+(t.month()-s.month()),e=s.clone().add(a,n),i=t-e<0,o=s.clone().add(a+(i?-1:1),n);return+(-(a+(t-e)/(i?e-o:o-e))||0)},a:function(r){return r<0?Math.ceil(r)||0:Math.floor(r)},p:function(r){return{M:n,y:l,w:M,d:w,D:S,h:k,m:O,s:V,ms:P,Q:A}[r]||String(r||"").toLowerCase().replace(/s$/,"")},u:function(r){return r===void 0}},L="en",F={};F[L]=lt;var et="$isDayjsObject",Q=function(r){return r instanceof J||!(!r||!r[et])},B=function r(s,t,a){var e;if(!s)return L;if(typeof s=="string"){var i=s.toLowerCase();F[i]&&(e=i),t&&(F[i]=t,e=i);var o=s.split("-");if(!e&&o.length>1)return r(o[0])}else{var m=s.name;F[m]=s,e=m}return!a&&e&&(L=e),e||!a&&L},v=function(r,s){if(Q(r))return r.clone();var t=typeof s=="object"?s:{};return t.date=r,t.args=arguments,new J(t)},f=ut;f.l=B,f.i=Q,f.w=function(r,s){return v(r,{locale:s.$L,utc:s.$u,x:s.$x,$offset:s.$offset})};var J=(function(){function r(t){this.$L=B(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[et]=!0}var s=r.prototype;return s.parse=function(t){this.$d=(function(a){var e=a.date,i=a.utc;if(e===null)return new Date(NaN);if(f.u(e))return new Date;if(e instanceof Date)return new Date(e);if(typeof e=="string"&&!/Z$/i.test(e)){var o=e.match(it);if(o){var m=o[2]-1||0,p=(o[7]||"0").substring(0,3);return i?new Date(Date.UTC(o[1],m,o[3]||1,o[4]||0,o[5]||0,o[6]||0,p)):new Date(o[1],m,o[3]||1,o[4]||0,o[5]||0,o[6]||0,p)}}return new Date(e)})(t),this.init()},s.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},s.$utils=function(){return f},s.isValid=function(){return this.$d.toString()!==tt},s.isSame=function(t,a){var e=v(t);return this.startOf(a)<=e&&e<=this.endOf(a)},s.isAfter=function(t,a){return v(t)<this.startOf(a)},s.isBefore=function(t,a){return this.endOf(a)<v(t)},s.$g=function(t,a,e){return f.u(t)?this[a]:this.set(e,t)},s.unix=function(){return Math.floor(this.valueOf()/1e3)},s.valueOf=function(){return this.$d.getTime()},s.startOf=function(t,a){var e=this,i=!!f.u(a)||a,o=f.p(t),m=function(N,y){var C=f.w(e.$u?Date.UTC(e.$y,y,N):new Date(e.$y,y,N),e);return i?C:C.endOf(w)},p=function(N,y){return f.w(e.toDate()[N].apply(e.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(y)),e)},$=this.$W,g=this.$M,x=this.$D,U="set"+(this.$u?"UTC":"");switch(o){case l:return i?m(1,0):m(31,11);case n:return i?m(1,g):m(0,g+1);case M:var H=this.$locale().weekStart||0,q=($<H?$+7:$)-H;return m(i?x-q:x+(6-q),g);case w:case S:return p(U+"Hours",0);case k:return p(U+"Minutes",1);case O:return p(U+"Seconds",2);case V:return p(U+"Milliseconds",3);default:return this.clone()}},s.endOf=function(t){return this.startOf(t,!1)},s.$set=function(t,a){var e,i=f.p(t),o="set"+(this.$u?"UTC":""),m=(e={},e[w]=o+"Date",e[S]=o+"Date",e[n]=o+"Month",e[l]=o+"FullYear",e[k]=o+"Hours",e[O]=o+"Minutes",e[V]=o+"Seconds",e[P]=o+"Milliseconds",e)[i],p=i===w?this.$D+(a-this.$W):a;if(i===n||i===l){var $=this.clone().set(S,1);$.$d[m](p),$.init(),this.$d=$.set(S,Math.min(this.$D,$.daysInMonth())).$d}else m&&this.$d[m](p);return this.init(),this},s.set=function(t,a){return this.clone().$set(t,a)},s.get=function(t){return this[f.p(t)]()},s.add=function(t,a){var e,i=this;t=Number(t);var o=f.p(a),m=function(g){var x=v(i);return f.w(x.date(x.date()+Math.round(g*t)),i)};if(o===n)return this.set(n,this.$M+t);if(o===l)return this.set(l,this.$y+t);if(o===w)return m(1);if(o===M)return m(7);var p=(e={},e[O]=T,e[k]=c,e[V]=_,e)[o]||1,$=this.$d.getTime()+t*p;return f.w($,this)},s.subtract=function(t,a){return this.add(-1*t,a)},s.format=function(t){var a=this,e=this.$locale();if(!this.isValid())return e.invalidDate||tt;var i=t||"YYYY-MM-DDTHH:mm:ssZ",o=f.z(this),m=this.$H,p=this.$m,$=this.$M,g=e.weekdays,x=e.months,U=e.meridiem,H=function(y,C,W,R){return y&&(y[C]||y(a,i))||W[C].slice(0,R)},q=function(y){return f.s(m%12||12,y,"0")},N=U||function(y,C,W){var R=y<12?"AM":"PM";return W?R.toLowerCase():R};return i.replace(ot,(function(y,C){return C||(function(W){switch(W){case"YY":return String(a.$y).slice(-2);case"YYYY":return f.s(a.$y,4,"0");case"M":return $+1;case"MM":return f.s($+1,2,"0");case"MMM":return H(e.monthsShort,$,x,3);case"MMMM":return H(x,$);case"D":return a.$D;case"DD":return f.s(a.$D,2,"0");case"d":return String(a.$W);case"dd":return H(e.weekdaysMin,a.$W,g,2);case"ddd":return H(e.weekdaysShort,a.$W,g,3);case"dddd":return g[a.$W];case"H":return String(m);case"HH":return f.s(m,2,"0");case"h":return q(1);case"hh":return q(2);case"a":return N(m,p,!0);case"A":return N(m,p,!1);case"m":return String(p);case"mm":return f.s(p,2,"0");case"s":return String(a.$s);case"ss":return f.s(a.$s,2,"0");case"SSS":return f.s(a.$ms,3,"0");case"Z":return o}return null})(y)||o.replace(":","")}))},s.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},s.diff=function(t,a,e){var i,o=this,m=f.p(a),p=v(t),$=(p.utcOffset()-this.utcOffset())*T,g=this-p,x=function(){return f.m(o,p)};switch(m){case l:i=x()/12;break;case n:i=x();break;case A:i=x()/3;break;case M:i=(g-$)/6048e5;break;case w:i=(g-$)/864e5;break;case k:i=g/c;break;case O:i=g/T;break;case V:i=g/_;break;default:i=g}return e?i:f.a(i)},s.daysInMonth=function(){return this.endOf(n).$D},s.$locale=function(){return F[this.$L]},s.locale=function(t,a){if(!t)return this.$L;var e=this.clone(),i=B(t,a,!0);return i&&(e.$L=i),e},s.clone=function(){return f.w(this.$d,this)},s.toDate=function(){return new Date(this.valueOf())},s.toJSON=function(){return this.isValid()?this.toISOString():null},s.toISOString=function(){return this.$d.toISOString()},s.toString=function(){return this.$d.toUTCString()},r})(),st=J.prototype;return v.prototype=st,[["$ms",P],["$s",V],["$m",O],["$H",k],["$W",w],["$M",n],["$y",l],["$D",S]].forEach((function(r){st[r[1]]=function(s){return this.$g(s,r[0],r[1])}})),v.extend=function(r,s){return r.$i||(r(s,J,v),r.$i=!0),v},v.locale=B,v.isDayjs=Q,v.unix=function(r){return v(1e3*r)},v.en=F[L],v.Ls=F,v.p={},v}))})(Z)),Z.exports}var _t=St();const Vt=ct(_t);var Ot={name:"Dropdown",extends:bt,mounted:function(){console.warn("Deprecated since v4. Use Select component instead.")}};const kt={class:"flex justify-between items-center"},Ct={class:"font-semibold text-xl text-gray-800 leading-tight"},jt={class:"py-12"},Yt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6"},Tt={class:"bg-white p-6 shadow sm:rounded-lg flex justify-between items-center"},At={class:"text-gray-600"},Ft={class:"text-gray-600"},Ht={class:"text-gray-600"},Nt={class:"bg-white p-6 shadow sm:rounded-lg"},Pt={class:"grid grid-cols-1 md:grid-cols-2 gap-8"},Ut={class:"flex flex-col gap-5"},It={class:"flex flex-col gap-2"},Lt={class:"grid grid-cols-2 gap-4"},qt={class:"flex flex-col gap-2"},Wt={class:"flex flex-col gap-2"},Et={class:"flex flex-col gap-2"},zt={class:"flex flex-col gap-2"},Bt={class:"mt-2 p-4 bg-gray-100 rounded-lg text-center"},Jt={class:"text-3xl font-bold text-green-600"},Rt={class:"flex flex-col gap-4 border-l pl-4 md:pl-8"},Zt={class:"font-semibold"},Gt={class:"flex justify-end gap-2 mt-8 pt-4 border-t"},ae={__name:"Show",props:{client:Object},setup(D){const X=D,_=E(!1),T=E([{name:"Semanal",code:"semanal"},{name:"Mensual",code:"mensual"}]),c=ft({client_id:X.client.id,amount:1e4,interest:10,installments:4,frequency:"semanal",start_date:new Date}),P=E([]),V=E(0),O=E(0),k=()=>{if(!c.amount||!c.installments)return;const M=c.amount*(1+c.interest/100);V.value=M;const n=M/c.installments;O.value=n;let A=[],l=Vt(c.start_date);for(let S=1;S<=c.installments;S++)c.frequency==="semanal"?l=l.add(1,"week"):l=l.add(1,"month"),A.push({number:S,date:l.format("DD/MM/YYYY"),amount:n.toFixed(2)});P.value=A};mt(()=>[c.amount,c.interest,c.installments,c.frequency,c.start_date],()=>{k()},{immediate:!0});const w=()=>{c.post(route("loans.store"),{onSuccess:()=>{_.value=!1,c.reset()}})};return(M,n)=>{const A=ht("tooltip");return yt(),pt(gt,null,[h(d(vt),{title:"Perfil de "+D.client.name},null,8,["title"]),h(dt,null,{header:b(()=>[u("div",kt,[u("h2",Ct," Perfil de "+j(D.client.name),1),h(d(nt),{href:M.route("clients.index")},{default:b(()=>[h(d(z),{label:"Volver a la Agenda",icon:"pi pi-arrow-left",severity:"secondary",text:""})]),_:1},8,["href"])])]),default:b(()=>[u("div",jt,[u("div",Yt,[u("div",Tt,[u("div",null,[n[11]||(n[11]=u("h3",{class:"text-lg font-bold text-gray-700 mb-2"},"Datos Personales",-1)),u("p",At,[n[8]||(n[8]=u("span",{class:"font-semibold"},"DNI:",-1)),I(" "+j(D.client.dni),1)]),u("p",Ft,[n[9]||(n[9]=u("span",{class:"font-semibold"},"Teléfono:",-1)),I(" "+j(D.client.phone||"No registrado"),1)]),u("p",Ht,[n[10]||(n[10]=u("span",{class:"font-semibold"},"Dirección:",-1)),I(" "+j(D.client.address||"No registrada"),1)])]),u("div",null,[h(d(z),{label:"Nuevo Préstamo",icon:"pi pi-wallet",severity:"success",onClick:n[0]||(n[0]=l=>_.value=!0)})])]),u("div",Nt,[n[13]||(n[13]=u("h3",{class:"text-lg font-bold text-gray-700 mb-4"},"Historial de Préstamos",-1)),h(d(at),{value:D.client.loans,tableStyle:"min-width: 50rem",stripedRows:""},{empty:b(()=>[...n[12]||(n[12]=[I(" Este cliente no tiene préstamos activos. ",-1)])]),default:b(()=>[h(d(Y),{field:"id",header:"# ID"}),h(d(Y),{field:"amount",header:"Monto Prestado"},{body:b(l=>[I(" $"+j(l.data.amount),1)]),_:1}),h(d(Y),{field:"start_date",header:"Fecha Inicio"},{body:b(l=>[I(j(new Date(l.data.start_date).toLocaleDateString()),1)]),_:1}),h(d(Y),{field:"status",header:"Estado"},{body:b(l=>[h(d(xt),{severity:l.data.status==="activo"?"warning":"success",value:l.data.status.toUpperCase()},null,8,["severity","value"])]),_:1}),h(d(Y),{header:"Acciones"},{body:b(l=>[h(d(nt),{href:M.route("loans.show",l.data.id)},{default:b(()=>[$t(h(d(z),{icon:"pi pi-eye",text:"",rounded:"",severity:"info"},null,512),[[A,"Ver Detalle y Cobrar"]])]),_:1},8,["href"])]),_:1})]),_:1},8,["value"])])])]),h(d(Dt),{visible:_.value,"onUpdate:visible":n[7]||(n[7]=l=>_.value=l),modal:"",header:"Simular Nuevo Préstamo",style:{width:"60rem"}},{default:b(()=>[u("div",Pt,[u("div",Ut,[n[20]||(n[20]=u("div",{class:"p-3 bg-blue-50 border border-blue-200 rounded-md"},[u("h4",{class:"font-bold text-blue-800 mb-1"},"Configuración"),u("p",{class:"text-sm text-blue-600"},"Ajusta los valores para calcular las cuotas.")],-1)),u("div",It,[n[14]||(n[14]=u("label",{class:"font-semibold"},"Monto a Prestar ($)",-1)),h(d(K),{modelValue:d(c).amount,"onUpdate:modelValue":n[1]||(n[1]=l=>d(c).amount=l),mode:"currency",currency:"ARS",locale:"es-AR",class:"w-full"},null,8,["modelValue"])]),u("div",Lt,[u("div",qt,[n[15]||(n[15]=u("label",{class:"font-semibold"},"Interés (%)",-1)),h(d(K),{modelValue:d(c).interest,"onUpdate:modelValue":n[2]||(n[2]=l=>d(c).interest=l),suffix:"%",min:0,max:100},null,8,["modelValue"])]),u("div",Wt,[n[16]||(n[16]=u("label",{class:"font-semibold"},"Nro. Cuotas",-1)),h(d(K),{modelValue:d(c).installments,"onUpdate:modelValue":n[3]||(n[3]=l=>d(c).installments=l),showButtons:"",min:1,max:48},null,8,["modelValue"])])]),u("div",Et,[n[17]||(n[17]=u("label",{class:"font-semibold"},"Frecuencia de Pago",-1)),h(d(Ot),{modelValue:d(c).frequency,"onUpdate:modelValue":n[4]||(n[4]=l=>d(c).frequency=l),options:T.value,optionLabel:"name",optionValue:"code",placeholder:"Seleccione...",class:"w-full"},null,8,["modelValue","options"])]),u("div",zt,[n[18]||(n[18]=u("label",{class:"font-semibold"},"Fecha de Inicio",-1)),h(d(wt),{modelValue:d(c).start_date,"onUpdate:modelValue":n[5]||(n[5]=l=>d(c).start_date=l),showIcon:"",dateFormat:"dd/mm/yy"},null,8,["modelValue"])]),u("div",Bt,[n[19]||(n[19]=u("p",{class:"text-sm text-gray-500"},"El cliente devolverá en total:",-1)),u("p",Jt,"$"+j(V.value.toFixed(2)),1)])]),u("div",Rt,[n[21]||(n[21]=u("h4",{class:"font-bold text-gray-700"},"Plan de Pagos (Vista Previa)",-1)),h(d(at),{value:P.value,scrollable:"",scrollHeight:"400px",size:"small",class:"text-sm"},{default:b(()=>[h(d(Y),{field:"number",header:"#"}),h(d(Y),{field:"date",header:"Vencimiento"}),h(d(Y),{field:"amount",header:"Monto Cuota"},{body:b(l=>[u("span",Zt,"$"+j(l.data.amount),1)]),_:1})]),_:1},8,["value"])])]),u("div",Gt,[h(d(z),{label:"Cancelar",severity:"secondary",onClick:n[6]||(n[6]=l=>_.value=!1)}),h(d(z),{label:"Aprobar y Guardar",icon:"pi pi-check",onClick:w,loading:d(c).processing},null,8,["loading"])])]),_:1},8,["visible"])]),_:1})],64)}}};export{ae as default};

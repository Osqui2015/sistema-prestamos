import{_ as w}from"./AuthenticatedLayout-nwCEQW_C.js";import{q as x,u as C,g as f,a,d as s,h as k,w as d,b as e,t as n,f as i,o as p,c as $,l as V,F as D}from"./app-DCFeNiTs.js";import{d as v,b as P,c as u,e as S,g as F}from"./index-DQuuFziJ.js";import{a as b}from"./index-DMXFl-X3.js";import"./ApplicationLogo-B6B4ioSt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"flex justify-between items-center"},U={class:"font-semibold text-xl text-gray-800 leading-tight"},j={class:"text-gray-500 text-sm"},A={class:"flex gap-2"},B=["href"],E={class:"py-12"},M={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6"},q={class:"bg-white p-6 shadow sm:rounded-lg grid grid-cols-1 md:grid-cols-4 gap-4"},I={class:"p-4 bg-gray-50 rounded border"},L={class:"text-xl font-bold text-gray-800"},N={class:"p-4 bg-green-50 rounded border border-green-200"},T={class:"text-xl font-bold text-green-700"},z={class:"p-4 bg-gray-50 rounded border"},O={class:"font-medium"},G={class:"p-4 bg-gray-50 rounded border flex flex-col justify-center items-center"},H={class:"bg-white p-6 shadow sm:rounded-lg"},J={key:0,class:"text-green-600 font-bold"},K={key:1,class:"text-gray-400"},Q={key:1,class:"text-green-600 text-sm font-bold flex items-center gap-1"},W={class:"flex flex-col gap-6"},X={class:"bg-blue-50 p-4 rounded text-sm text-blue-800 border border-blue-200"},Y={class:"flex flex-col gap-2"},Z={class:"flex justify-end gap-2 mt-2 border-t pt-4"},ne={__name:"Show",props:{loan:Object},setup(o){const c=x(!1),m=x(null),r=C({amount:0}),_=g=>{m.value=g,r.amount=parseFloat(g.amount),c.value=!0},h=()=>{r.post(route("installments.pay",m.value.id),{onSuccess:()=>{c.value=!1,r.reset()}})};return(g,t)=>(p(),f(D,null,[a(s(k),{title:"Detalle del Préstamo"}),a(w,null,{header:d(()=>[e("div",R,[e("h2",U,[i(" Préstamo #"+n(o.loan.id)+" ",1),e("span",j,"| "+n(o.loan.client.name),1)]),e("div",A,[e("a",{href:g.route("loans.pdf",o.loan.id),target:"_blank"},[a(s(b),{label:"Descargar PDF",icon:"pi pi-file-pdf",severity:"danger",outlined:""})],8,B),a(s(V),{href:g.route("clients.show",o.loan.client.id)},{default:d(()=>[a(s(b),{label:"Volver al Cliente",icon:"pi pi-arrow-left",severity:"secondary",text:""})]),_:1},8,["href"])])])]),default:d(()=>[e("div",E,[e("div",M,[e("div",q,[e("div",I,[t[3]||(t[3]=e("p",{class:"text-gray-500 text-sm"},"Monto Prestado",-1)),e("p",L,"$"+n(o.loan.amount),1)]),e("div",N,[t[4]||(t[4]=e("p",{class:"text-green-600 text-sm font-semibold"},"Total a Cobrar",-1)),e("p",T,"$"+n(o.loan.total_payable),1)]),e("div",z,[t[5]||(t[5]=e("p",{class:"text-gray-500 text-sm"},"Interés / Frecuencia",-1)),e("p",O,n(o.loan.interest_rate)+"% - "+n(o.loan.frequency.toUpperCase()),1)]),e("div",G,[t[6]||(t[6]=e("p",{class:"text-gray-500 text-sm mb-1"},"Estado Actual",-1)),a(s(v),{value:o.loan.status.toUpperCase(),severity:o.loan.status==="activo"?"warning":"success"},null,8,["value","severity"])])]),e("div",H,[t[8]||(t[8]=e("h3",{class:"font-bold text-lg mb-4 text-gray-700"},"Plan de Pagos y Cobros",-1)),a(s(P),{value:o.loan.installments,stripedRows:"",tableStyle:"min-width: 50rem"},{default:d(()=>[a(s(u),{field:"installment_number",header:"#"}),a(s(u),{field:"due_date",header:"Vencimiento"},{body:d(l=>[i(n(new Date(l.data.due_date).toLocaleDateString()),1)]),_:1}),a(s(u),{field:"amount",header:"Monto Cuota"},{body:d(l=>[i(" $"+n(l.data.amount),1)]),_:1}),a(s(u),{field:"amount_paid",header:"Pagado"},{body:d(l=>[l.data.amount_paid>0?(p(),f("span",J," $"+n(l.data.amount_paid),1)):(p(),f("span",K,"-"))]),_:1}),a(s(u),{header:"Estado"},{body:d(l=>[a(s(v),{severity:l.data.status==="pagado"?"success":"danger",value:l.data.status.toUpperCase()},null,8,["severity","value"])]),_:1}),a(s(u),{header:"Acción"},{body:d(l=>[l.data.status!=="pagado"?(p(),$(s(b),{key:0,icon:"pi pi-dollar",label:"Cobrar",size:"small",severity:"success",onClick:y=>_(l.data)},null,8,["onClick"])):(p(),f("span",Q,[...t[7]||(t[7]=[e("i",{class:"pi pi-check-circle"},null,-1),i(" Listo ",-1)])]))]),_:1})]),_:1},8,["value"])])])]),a(s(S),{visible:c.value,"onUpdate:visible":t[2]||(t[2]=l=>c.value=l),modal:"",header:"Registrar Pago",style:{width:"30rem"}},{default:d(()=>{var l;return[e("div",W,[e("div",X,[t[9]||(t[9]=i(" Estás registrando el cobro de la ",-1)),e("strong",null,"Cuota #"+n((l=m.value)==null?void 0:l.installment_number),1),t[10]||(t[10]=i(".",-1)),t[11]||(t[11]=e("br",null,null,-1)),i(" Vencimiento: "+n(m.value?new Date(m.value.due_date).toLocaleDateString():""),1)]),e("div",Y,[t[12]||(t[12]=e("label",{class:"font-bold text-gray-700"},"Monto Recibido ($)",-1)),a(s(F),{modelValue:s(r).amount,"onUpdate:modelValue":t[0]||(t[0]=y=>s(r).amount=y),mode:"currency",currency:"ARS",locale:"es-AR",class:"w-full",min:0},null,8,["modelValue"]),t[13]||(t[13]=e("small",{class:"text-gray-500"},"Ingrese el monto exacto que entregó el cliente.",-1))]),e("div",Z,[a(s(b),{label:"Cancelar",severity:"secondary",onClick:t[1]||(t[1]=y=>c.value=!1)}),a(s(b),{label:"Confirmar Pago",icon:"pi pi-check",onClick:h,loading:s(r).processing,severity:"success"},null,8,["loading"])])])]}),_:1},8,["visible"])]),_:1})],64))}};export{ne as default};
